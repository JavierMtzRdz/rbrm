% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.rbrm.r
\name{cv_rbrm}
\alias{cv_rbrm}
\title{Cross-Validation for Regularized Binary Regression Model (RBRM)}
\usage{
cv_rbrm(va, vb, x, y, lambda = NULL, n_lambdas = 50, nfolds = 3, ...)
}
\arguments{
\item{va}{A matrix of independent variables (without an intercept) for alpha.}

\item{vb}{A matrix of independent variables (without an intercept) for beta.}

\item{x}{A vector indicating the group assignment (1 or 0) for each observation.}

\item{y}{A vector of binary outcomes (0/1).}

\item{lambda}{Optional. A vector of lambda values for regularization. If NULL, a grid of values will be generated.}

\item{n_lambdas}{The number of lambda values to generate if lambda is NULL. Default is 50.}

\item{nfolds}{The number of folds for cross-validation. Default is 3. Must be at least 2.}

\item{...}{Additional arguments passed to the \code{rbrm} function.}
}
\value{
A list containing:
\item{lambda}{The best lambda value selected based on cross-validation.}
\item{alpha}{The estimated alpha coefficients from the best fit model.}
\item{beta}{The estimated beta coefficients from the best fit model.}
\item{convergence}{Logical indicating whether convergence was achieved.}
\item{step}{The number of steps taken for convergence.}
\item{cv_mean_deviance}{The mean deviance across all folds for each lambda.}
\item{fold_deviances}{A list of deviances for each fold.}
\item{best_lambda_idx}{The index of the best lambda in the lambda grid.}
\item{model_history}{An array storing the coefficients for each lambda across folds.}
\item{lambda_grid}{The grid of lambda values used in cross-validation.}
}
\description{
This function performs k-fold cross-validation to tune the regularization parameter (lambda)
for the RBRM model. The optimal lambda is selected based on the minimum deviance.
}
\examples{
# Example usage:
#va <- matrix(c(1, 1, 1, 1, 0, 0, 0, 0), ncol = 2)
#vb <- matrix(c(1, 1, 0, 0, 1, 1, 0, 0), ncol = 2)
#y <- c(1, 0, 1, 0)
#x <- c(1, 1, 0, 0)
#cv_result <- cv_rbrm(va, vb, x, y, nfolds = 3)

}
